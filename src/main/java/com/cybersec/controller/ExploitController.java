package com.cybersec.controller;

import com.cybersec.exploit.ExploitEngine;
import org.springframework.web.bind.annotation.*;

import java.util.Map;

@RestController
@RequestMapping("/api/exploit")
public class ExploitController {

    private final ExploitEngine exploitEngine;

    public ExploitController(ExploitEngine exploitEngine) {
        this.exploitEngine = exploitEngine;
    }

    @GetMapping("/run")
    public Map<String, String> runExploit(@RequestParam String target, @RequestParam int port) {
        return exploitEngine.runExploit(target, port);
    }
}