package com.cybersec.controller;

import com.cybersec.exploit.BruteForceSimulator;
import com.cybersec.exploit.ExploitEngine;
import org.springframework.web.bind.annotation.*;

import java.util.Map;

@RestController
@RequestMapping("/api/exploit")
public class ExploitController {

    private final ExploitEngine exploitEngine;
    private final BruteForceSimulator bruteForceSimulator;

    public ExploitController(ExploitEngine exploitEngine, BruteForceSimulator bruteForceSimulator) {
        this.exploitEngine = exploitEngine;
        this.bruteForceSimulator = bruteForceSimulator;
    }

    @GetMapping("/run")
    public Map<String, String> runExploit(@RequestParam String target, @RequestParam int port) {
        return exploitEngine.runExploit(target, port);
    }

    @GetMapping("/brute-ssh")
    public Map<String, String> bruteSsh(@RequestParam String target, @RequestParam int port) {
        return bruteForceSimulator.bruteForce(target, port);
    }
}